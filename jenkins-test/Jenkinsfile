pipeline {
    agent any
    environment{
        IMAGE = 'rueba-node'
        REGISTRY = 'manuBarrionuevo'
        DOCKER_HUB_LOGIN = credentials('docker')
    }
    stages { // el principal donde se arman la tuberia 
        //CI
        stage('docker build') {
            steps {
                sh 'docker build -t $IMAGE .'
            }
        }
        stage('deploy to hub') {
            steps {
                sh ''' 
                            docker login --username=$DOCKER_HUB_LOGIN_USR --password=$DOCKER_HUB_LOGIN_PSW
                            docker tag prueba-node:v1 $REGISTRY/$IMAGE:v1
                            docker push $REGISTRY/$IMAGE:v1
                            '''
                }
            }
        }
       
    } //fin stage principal
}